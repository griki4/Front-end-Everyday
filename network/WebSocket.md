今天结合阮一峰老师的博客和`MDN`的文档对于`WebSocket`协议做了一个简单的了解。

## why?

`WebSocket`也是一种网络协议，和`http`是一类东西。

它的出现是为了解决一些对于实时性要求比较高的应用场景问题，比如聊天室，客户端这边必须要时刻知道服务器数据发生了什么改变。

传统的`http`必须由客户端发起请求，服务端才会响应，要实现这样的方式就得采用轮询或者长链接的方式。虽然可以解决问题但是非常低效，浪费资源。所以有了`WebSocket`。

该协议可以说实现了真正的平等，客户端可以随时请求服务端，而服务端这边则可以主动向客户端推送信息了。

### what?

`WebSocket`协议的地址是这样的。

```javascript
ws://example.com:3000/some/path
```

如果还有一个s就说明使用了加密的版本。

### how?

1. 创建实例。

```javascript
const ws = new WebSocket(url) //实例化一个websocket
```

1. 监听状态

`ws.readyState`可以表示建立`WebSocket`连接的各个阶段，和`ajax`请求一样。

- 0 。`CONNECTING`状态，正在建立连接
- 1。`OPEN`，连接已经建立，可以进行通信了。
- 2。`CLOSING`，连接正在关闭。
- 3。`cLOSED`，连接已经关闭或者说没有连接成功。

1. 实例方法

- `close`，关闭连接，可以传入提示码或者字符串提示关闭连接的原因。
- `send`，参数为需要进行传输的数据。

1. 事件。

- `onopen`，建立连接时触发的回调函数。
- `onerror`，连接出现错误的时候触发的回调。
- `onmessage`，接收到传输的数据的时候触发的回调。
- `onclosed`，关闭连接时触发的回调。



最后就是一些比较有名的库了，比如`Socket.IO`这种，还没有试过，有空可以尝尝鲜。