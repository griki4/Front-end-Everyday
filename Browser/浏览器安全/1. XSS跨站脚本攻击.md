## Corss-site scripting（跨站脚本攻击）

最为常见的攻击方式，也是最为普遍的`web`安全漏洞。其攻击方式是在页面中嵌入恶意代码，使其在用户的浏览器上运行，从而到达盗取用户`cookie`等目的。

常见的`XSS`的危害：

- 获取`cookie`，`LocalStorage`等用户隐私信息。
- `DOS`攻击，发送合理的请求占用服务器，使用户无法访问浏览器。
- 改变页面`DOM`结构，伪造虚假的弹窗，制造悬浮广告等。
- 流量劫持，比如链接到另一个网站。

### 类型

- 存储型`XSS`：黑客将恶意代码上传到有漏洞的`web`服务器，用户浏览器向服务器请求资源，服务器将恶意代码和资源一并返回，浏览器解析资源的同时将恶意代码一并执行。恶意代码窃取用户`cookie`等信息上传到目标服务器，或者冒充用户进行操作。这种`XSS`非常危险，又称为持久型`XSS`。
- 反射型`XSS`：黑客诱导用户点击攻击链接才能触发的`XSS`代码，用户点击恶意链接将恶意代码发送到服务器，服务器又将恶意代码返回到用户浏览器中执行，形成了一个“反射”的过程。**和存储型的区别在于服务器不会存储恶意代码。**
- `DOM`型`XSS`：类似反射型，攻击的特点是基于`DOM`树的修改实现的。比如在`<script>`,`<img>`等标签中放入`URL`链接，这些标签不受同源策略限制，就给了恶意代码执行的机会。

### 防御

- 服务器对输入脚本过滤和转码。`XSS`本质上是恶意代码的执行，因此可以在服务器端设置策略过滤掉恶意代码，或者直接进行转码让恶意代码无法执行。

- `CSP`白名单。`CSP`本质上就是建立一个白名单，它告诉浏览器哪些资源可以进行加载执行，从而实现防止恶意代码执行。

  > 实现`CSP`的方式有两种。一种是利用`http`头部的`Content-Security-Policy`属性，或者设置`<meta>`标签

- 对于`cookie`等信息设置`HttpOnly`使其不对`js`代码开放。